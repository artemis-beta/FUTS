CMAKE_MINIMUM_REQUIRED(VERSION 3.12)

ENABLE_LANGUAGE(Fortran)

PROJECT(FUTS_Demo_Project_Tests)

SET(CMAKE_Fortran_COMPILER gfortran)

GET_FILENAME_COMPONENT(PROJECT_ROOT ../../ ABSOLUTE)

MESSAGE(STATUS "[FUTS Example Project Build]")
MESSAGE(STATUS "\tProject Source Directory: ${PROJECT_ROOT}")

FILE(GLOB FUTS_FILES ${PROJECT_ROOT}/src/*.f90)
FILE(GLOB SRC_FILES ${CMAKE_SOURCE_DIR}/src/*.f90)
FILE(GLOB TEST_SRCS ${CMAKE_SOURCE_DIR}/tests/*.f90)

ADD_LIBRARY(FUTS ${FUTS_FILES})
ADD_LIBRARY(DEMO_PROJ ${SRC_FILES})

ADD_EXECUTABLE(${PROJECT_NAME} ${FUTS_FILES} ${SRC_FILES} ${TEST_SRCS})
TARGET_LINK_LIBRARIES(
    ${PROJECT_NAME}
    PUBLIC FUTS
    PUBLIC DEMO_PROJ
)
SET_TARGET_PROPERTIES(
    ${PROJECT_NAME}
    PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin"
)
